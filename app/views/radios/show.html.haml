.row
  %ul.radionav
    - (1..@radios.count).each do |i|
      %li
        - if @radio.id == i
          =link_to @radios.find_by(id:i).name, radio_path(id: i), class: 'highlighted'
        - else
          =link_to @radios.find_by(id:i).name, radio_path(id: i)

.row
  .col-md-1
  .col-md-5
    .radio_container
      .station_title
        %h3
          = @radio.name.titleize + ' - ' + @radio.description.camelize
      .station_player
        #player
          %script{:type=>"text/javascript", :src=>@radio.player}
        #songtitle
          #artist
          #song
      #artist_summary
      #album_summary

  .col-md-1    

= javascript_include_tag 'jquery.shoutcast.min.js'

%script{:type=>"text/javascript"}

  setInterval(function(){

  $.SHOUTcast({host : 'eclipse.wavestreamer.com',port:3771}).stats(function(){
  
  // Capture artist and song from Shoutcast server
  var artist = this.get('songtitle').substring(0, this.get('songtitle').indexOf(" - "));
  var song = this.get('songtitle').substring(this.get('songtitle').indexOf(" - ") + 3);
  var locale = "#{I18n.locale}";
  
  // Append artist and song to player
  $('#artist').text(artist);
  $('#song').text(song);

  // Ajax call artist summary partial based on artist variable
  ($.ajax({data: { artist_name: artist }, type: 'get', url: "/" + locale + "/artist_summary", success: function(r) { $('#artist_summary').html(r); } }));

  // Ajax call album summary partial based on artist and song variable
  ($.ajax({data: { song_name: song, artist_name: artist }, type: 'get', url: "/" + locale + "/album_summary", success: function(r) { $('#album_summary').html(r); } }));

  });

  // Do all of this periodically
  },4000);